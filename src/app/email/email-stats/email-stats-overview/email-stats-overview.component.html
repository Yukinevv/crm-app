<div class="card mb-4">
  <div class="card-header d-flex align-items-center justify-content-between">
    <div>Top 10 wiadomości (po liczbie kliknięć)</div>

    <div class="d-flex align-items-center" style="gap:.5rem;">
      <div class="input-group" style="width: 230px;">
        <span class="input-group-text">Dni</span>
        <input type="number" class="form-control ml-2" [(ngModel)]="sinceDays" min="1">
        <button class="btn btn-primary ml-2" (click)="onRefreshClick()" [disabled]="refreshing">
          Odśwież
          <span class="spinner-border spinner-border-sm ms-1" *ngIf="refreshing"></span>
        </button>
      </div>
      <button class="btn btn-outline-primary ml-4" (click)="onExportSummaryClick()">
        Eksport podsumowania (CSV)
      </button>
    </div>
  </div>

  <div class="card-body chart-holder">
    <canvas #topChart></canvas>
  </div>

  <div class="card-body pt-0">
    <div class="table-responsive" style="max-height: 360px; overflow:auto;">
      <table class="table table-sm align-middle">
        <thead>
        <tr>
          <th>Temat</th>
          <th>Do</th>
          <th>Data</th>
          <th class="text-end">Kliknięcia</th>
          <th></th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let row of summary"
            [class.table-active]="selectedMessageId === row.messageId">
          <td style="max-width: 320px">{{ row.subject }}</td>
          <td>{{ row.to }}</td>
          <td>{{ row.date | date:'short' }}</td>
          <td class="text-end"><strong>{{ row.clicks }}</strong></td>
          <td class="text-nowrap">
            <button class="btn btn-sm btn-outline-primary me-2" (click)="onSelectRow(row)">Szczegóły</button>
            <button class="btn btn-sm btn-outline-secondary ml-2" (click)="onExportClicksRow(row)">CSV</button>
          </td>
        </tr>
        <tr *ngIf="!summary.length && !loading">
          <td colspan="5" class="text-center text-muted">Brak danych</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
